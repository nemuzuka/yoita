//ユーザメンテナンスのjs
function initSelfUserDialog(){$("#selfUserDialog").dialog({modal:!0,autoOpen:!1,width:700,resizable:!1,open:function(e){openModalDialog()},close:function(e){closeModelDialog()},show:"clip",hide:"clip"}),$("#selfUserDialog-add").click(function(){executeSelfUser()}),$("#selfUserDialog-cancel").click(function(){$("#selfUserDialog").dialog("close")})}function openSelfUserDialog(){var e="ユーザ情報",t="変更する";$("#ui-dialog-title-selfUserDialog").empty(),$("#ui-dialog-title-selfUserDialog").append(e),$("#selfUserDialog-add").attr({value:t});var n={};setAjaxDefault();var r;r=$.ajax({type:"GET",url:"/ajax/userInfos/show_self"}),r.pipe(function(e){if(errorCheck(e)==0)return;var t=e.result.detail,n=t.resource;$("#self_resource_name").val(n.name),$("#self_resource_memo").val(n.memo),$("#self_resource_lock_version").val(n.lock_version);var r=t.user_info;$("#self_reading_character").val(r.reading_character),$("#self_tel").val(r.tel),$("#self_mail").val(r.mail);var i=e.result.user_group_list;$("#self_default_user_group").empty(),i!=null&&$.each(i,function(){$("#self_default_user_group").append($("<option />").attr({value:this.key}).text(this.value))}),$("#self_default_user_group").val(r.default_user_group),$("#self_per_page").val(r.per_page),$("#self_user_info_lock_version").val(r.lock_version),login=t.login,$("#self_confirm_password").val(""),$("#self_update_password").val(""),$("#self_update_confirm_password").val(""),$("#self_login_lock_version").val(login.lock_version),prependDummyText("selfUserDialog"),$("#selfUserDialog").dialog("open"),removeDummyText("selfUserDialog");return})}function executeSelfUser(){var e=createExecuteSelfUserParams();if(validateSelfUser(e)==0)return;setAjaxDefault();var t;t=$.ajax({type:"POST",url:"/ajax/userInfos/save_self",data:e}),t.pipe(function(e){if(errorCheck(e)==0&&e.status_code==-1)return;infoCheck(e),$("#selfUserDialog").dialog("close");return})}function createExecuteSelfUserParams(){var e={};e.resource={};var t=e.resource;t.name=$("#self_resource_name").val(),t.memo=$("#self_resource_memo").val(),t.lock_version=$("#self_resource_lock_version").val(),e.user_info={};var n=e.user_info;n.reading_character=$("#self_reading_character").val(),n.tel=$("#self_tel").val(),n.mail=$("#self_mail").val(),n.default_user_group=$("#self_default_user_group").val(),n.per_page=$("#self_per_page").val(),n.lock_version=$("#self_user_info_lock_version").val(),e.login={};var r=e.login;return r.confirm_password=$("#self_confirm_password").val(),r.password=$("#self_update_password").val(),r.update_confirm_password=$("#self_update_confirm_password").val(),setToken(e),e}function validateSelfUser(e){var t=new Validate,n=e.resource;t.addRules({value:n.name,option:"required",error_args:"ユーザ名"}),t.addRules({value:n.name,option:"maxLength",error_args:"ユーザ名",size:128});var r=e.user_info;t.addRules({value:n.reading_character,option:"maxLength",error_args:"ふりがな",size:128});var i=e.login;if(i["confirm_password"]!=null&&i["confirm_password"]!=""||i["password"]!=null&&i["password"]!=""||i["update_confirm_password"]!=null&&i["update_confirm_password"]!="")t.addRules({value:i.confirm_password,option:"required",error_args:"変更前パスワード"}),t.addRules({value:i.password,option:"minLength",error_args:"変更パスワード",size:6}),t.addRules({value1:i.password,value2:i.update_confirm_password,option:"eachValue",error_args:"変更パスワード",error_args2:"変更パスワード(確認用)"});return t.addRules({value:r.tel,option:"maxLength",error_args:"TEL",size:48}),t.addRules({value:r.mail,option:"maxLength",error_args:"メールアドレス",size:256}),t.addRules({value:n.memo,option:"maxLength",error_args:"メモ",size:1024}),t.execute()}$(function(){initSelfUserDialog()});