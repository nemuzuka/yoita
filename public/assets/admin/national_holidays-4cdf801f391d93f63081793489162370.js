//祝日管理のjs
function changeTargetYear(){$("#result_area").empty();var e=$("#target_year").val();if(e=="")return;var t={};t.target_year=e,setAjaxDefault(),$.ajax({type:"GET",data:t,url:"/ajax/nationalHolidays/get_holidays_info/"}).then(function(t){if(errorCheck(t)==0)return;var n=t.result,r=$("<div />").addClass("widget"),i=$("<div />").addClass("widget-header").append($("<h2 />").addClass("title").text(e+"年の祝日")),s=$("<div />").addClass("widget-content"),o=$("<table />").attr({id:"result_list"}).addClass("result_table"),u=$("<span />").text(" 例）01/01").addClass("important-msg"),a=$("<thead />").append($("<tr />").append($("<th />").text("対象日付").append(u).attr({width:"200px"})).append($("<th />").text("メモ")).append($("<th />").text("").attr({width:"50px"})));o.append(a);var f=$("<tbody />");$.each(n,function(e){var t=createHolidayTr(this.target_month_day,this.memo);f.append(t)}),o.append(f);var l=$("<input />").attr({type:"button",value:"変更する"}).addClass("btn btn-primary");l.click(function(){updateHoliday()});var c=$("<div />").addClass("search_ctrl").append(l),h=$("<div />").addClass("search_ctrl"),p=$("<input />").attr({value:"祝日追加",type:"button"}).addClass("btn");p.click(function(){addHoliday()}),h.append(p),s.append(h).append(o).append(c),r.append(i).append(s),$("#result_area").append(r)})}function addHoliday(){var e=createHolidayTr("","");$("#result_list tbody").append(e)}function createHolidayTr(e,t){var n=$("<input />").attr({type:"button",value:"削除"}).addClass("btn btn-danger btn-mini");n.click(function(){$(this).parent().parent().remove()});var r=$("<tr />"),i=$("<input />").attr({type:"text",name:"targetDate"}).val(formatDateMMdd(e)).addClass("input-small");setMMddFormatEvent(i);var s=$("<input />").attr({type:"text",name:"memo"}).val(t).addClass("input-xlarge");return r.append($("<td />").append(i)).append($("<td />").append(s)).append($("<td />").append(n)),r}function updateHoliday(){var e=createParams();if(validate(e)==0)return;setAjaxDefault(),$.ajax({type:"POST",data:e,dataType:"json",url:"/ajax/nationalHolidays/update"}).then(function(e){if(errorCheck(e)==0&&e.status_code==-1)return;infoCheck(e),changeTargetYear()})}function createParams(){var e={};return e.target_year=$("#target_year").val(),e.target_day_list=getTextArray("targetDate",!0),e.memo_list=getTextArray("memo",!1),setToken(e),e}function validate(e){var t=new Validate;return t.addRules({value:e.target_day_list,option:"day4List",error_args:"対象日付"}),t.addRules({value:e.memo_list,option:"maxLength4List",error_args:"メモ",size:1024}),t.execute()}function getTextArray(e,t){var n=[];return $("input[type='text'][name='"+e+"']").each(function(){t?n.push(unFormatDate($(this).val())):n.push($(this).val())}),n}$(function(){$("#target_year").empty();var e=new DateFormat("yyyy"),t=e.format(new Date);$("#target_year").append($("<option>").attr({value:""}).text(""));for(var n=0;n<5;n++){var r=t-1+n;$("#target_year").append($("<option>").attr({value:r}).text(r))}$("#target_year").change(function(){changeTargetYear()}),$("#target_year").val(t),$("#target_year").change()});